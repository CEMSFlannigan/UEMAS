probeDv = [1274,1990,3291]; %D4sigma
probeDh = [1136,1609,3179];

pumpDv = [2127, 2168, 2254, 2374, 2483, 2562, 2602, 2641, 2796];
pumpDh = [2716, 2766, 2872, 3023, 3158, 3248, 3290, 3333, 3516];

probePos = [0,14.5,30].*25400;
pumpPos = [798.3, 749.9, 648.2, 498.0, 351.4, 253.3, 199.5, 150.7, -51.5].*1000;
pumpPos = -1*(pumpPos - pumpPos(1))

probeDvSq = probeDv.^2;
probeDhSq = probeDh.^2;

xmatr = [1, probePos(1), probePos(1)^2; 1, probePos(2), probePos(2)^2; 1, probePos(3), probePos(3)^2];

xmatr\probeDvSq'

init_delay_zero = 786.2*1000; %lens position

pos = [733.8, 723.1, 713.2, 686.5, 537.4, 582.8, 550.4, 540.0, 670.3, 700.0, 520.0,702.0, 704.0].*1000;
pos = -1.*(pos - init_delay_zero);
Dx = [1351, 972, 617, 341, 4538, 3374, 4224, 4483, 927, 128, 4877];
Dy = [1066, 765, 486, 265, 3972, 3025, 3736, 3929, 741, 105, 4166];

init_delay_zero = 786.2*1000; %lens position

pos = [537.4, 550.4, 540.0, 700.0,702.0, 704.0].*1000;
pos = -1.*(pos - init_delay_zero);
Dx = [4538, 4224, 4483, 128, 202, 275];
Dy = [3972, 3736, 3929, 105, 388, 217];


DxSq = Dx.^2;

xmatr = [ones(length(pos),1), pos', pos'.^2];



%%%%%%%%%%%%%%%

StartSep = 5.45; % cm
Position = [630.090000000000;638.020000000000;645.940000000000;653.980000000000;662.020000000000;670.030000000000;673.970000000000;678.140000000000;682.010000000000;686.090000000000;688.060000000000;690.030000000000;691.080000000000;691.950000000000;692.520000000000;693.140000000000;694.070000000000;696.040000000000;698.110000000000;702.010000000000;706.020000000000;710.020000000000;726.060000000000]; % mm
Position = abs(Position - max(Position)) + StartSep*10;

xDiam = 0.1*[1939.50000000000;1739.33333333333;1476.66666666667;1264;1016;761.383333333333;631.350000000000;491.033333333333;374;233.233333333333;164.783333333333;97.5683333333333;63.8033333333333;39.5833333333333;29.9400000000000;31.5133333333333;52.5783333333333;118.933333333333;188.050000000000;316.250000000000;452.250000000000;584.683333333333;1095];
yDiam = 0.1*[1583.33333333333;1410.83333333333;1200;1012.16666666667;803.850000000000;599.866666666667;495.666666666667;381.250000000000;285.650000000000;172;119.166666666667;67.2983333333333;43.1816666666667;29.4750000000000;27.9066666666667;35.9233333333333;56.0933333333333;106.583333333333;161.466666666667;264.050000000000;372.183333333333;476.466666666667;890.200000000000];

