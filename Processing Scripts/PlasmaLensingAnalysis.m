% 2018_07_29 PL_03

% Loc_01
% timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
% widthData = [319.173428110916,318.619810788338,318.970770344469,319.035091176327,318.492640503349,319.620734231169,319.250124378582,319.447260447455,319.048297841321,319.615809806530,319.336272052062,318.876700765303,319.577854971228,319.830855685832,318.839097433420,319.837549784866,319.325832449418,319.862630460569,320.058604165443,319.704578758677,320.189992793982,323.253925284341,324.374615154120,321.951825108116,325.942497545295,327.123340635503,326.129582396085,326.962323733717,327.538983585385,326.000234588632,326.413467192143,324.961160518451,325.314581885580,323.754449048403,324.147832483606,324.148406094417,323.210590455171,323.375246318175,323.010420781185,322.429825493759,323.537149991260,323.752621948730,322.680637525844,323.280071835938,322.932049197841,321.561212437716,322.005711016019,321.931095416635,322.143575282738,321.900248666934,322.084993084313,322.192513480885,321.784612146540,321.179214233094,321.660584399740,320.657327885305,321.370248733165,321.581145505666,320.402647907425,321.684728166619,320.625506030739,321.677654014095,321.100062018141,429.062055888593,321.942743247616,320.142235491211,320.781124320936,321.275906740717,320.607734113755,320.702700018420,318.777920140399]';
% timeArr = timeArr(widthData < 400);
% widthData = widthData(widthData < 400);
% widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(21:29);
% widthROI = widthData(21:29);

% Loc_02
%timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
%widthData = [336.272679795793,336.191371221581,335.616273085511,335.954319760118,335.942204436324,335.626363290974,335.883303254561,336.344398846519,335.760998076531,336.210203844685,335.860021567293,335.699259744961,336.323121620663,335.723691570837,335.823598528454,335.936899259866,336.613523604579,337.037802239655,336.411393601529,336.811926248062,337.779653463576,341.133354857548,341.641097817886,342.595298820142,341.628299245531,342.451130426179,342.248953338324,342.852185672125,342.530689925757,342.604609133069,341.968549471216,341.708683791156,341.433905100055,341.222307679971,341.242103925631,339.936293552251,340.551834638485,340.573275456805,339.659298084213,339.606752222273,339.226495957981,338.656346716690,339.396731357428,339.529718626928,338.397065933122,339.077760581973,339.442388872911,338.417712601008,338.581397652516,338.903703446898,339.102746639855,338.261909578528,337.835482732961,338.221626345724,338.213009847322,338.072836164356,338.643263722151,337.879312411627,337.735239670355,337.946117739542,337.616729756095,336.699175057465,337.450081486771,338.299420282288,337.415250774548,337.899321751887,337.832937287182,337.757114927217,337.989289103639,336.620172456555,337.975843112704]';
%widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
%timeROI = timeArr(16:26);
%widthROI = widthData(16:26);

% Loc_03
% timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
% widthData = [325.136242140461,326.083124031691,326.438155397722,325.278433741939,326.189242897951,324.781083803616,325.240875302455,325.813550274906,325.634876941793,325.477135267923,325.461538236238,437.452953091522,325.298435115219,325.945973752375,325.849721289572,326.070514608166,326.124426158949,325.352093007046,326.911514461628,422.995348762677,326.540968600714,328.630545931457,328.503216034772,640.046588173663,330.093251946766,330.393725466609,330.217476787378,331.734425366626,331.535899874083,331.471499627282,330.524728222956,329.739530573793,330.483155364076,330.620207159652,329.721427031227,329.727384635593,329.186475052797,420.317688698452,328.877124919061,328.898781768098,328.640061271047,328.667205847011,328.273669651116,328.416066482899,327.910309790121,327.614920783330,328.263889966594,328.120779004517,327.020397370539,328.273390791793,327.038184123409,327.804766761544,327.774145878672,327.256894462792,327.620673188791,405.913722844813,326.909574182954,327.236743220490,327.288353039167,327.207958011896,327.567342186101,326.720830881175,328.087601084776,326.771449957288,325.777220536825,327.166115350958,430.225048299245,328.026511259662,327.014827801111,326.954869095447,326.688593323201]';
% timeArr = timeArr(widthData < 400);
% widthData = widthData(widthData < 400);
% widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(17:25);
% widthROI = widthData(17:25);

% Loc_04
% timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
% widthData = [335.648391274881,336.534093970602,336.376844678270,336.215327598022,335.608906097085,336.053229148474,336.595936007145,336.230399434082,336.865628808226,336.222944671693,336.250712213527,335.760305017730,337.008423576736,336.749364378070,336.220961156926,336.718547886893,336.617008763477,336.704288510250,337.516516095656,338.197711731230,338.739643220992,341.474722824341,342.297014246016,343.091314963254,343.356134771260,344.283441644645,343.365975013942,343.906258869161,343.670833009959,342.713262182046,342.530338836507,342.282944410435,341.954992569329,341.386972066122,340.840050518610,341.280388748421,341.353327695843,340.772922450466,339.613949259371,339.481128425628,339.434866285046,339.659739763860,339.325367469421,339.514183914993,340.028529430736,338.457938711912,339.128994802046,339.538480671174,338.468078789137,338.738439861035,338.151900195377,338.735762468838,338.722374808890,338.133847061883,338.554309836475,338.608553446069,338.184722666825,337.926571017162,337.955829430701,337.570070750583,337.691888264085,337.941073086266,337.930976369363,338.708698818442,337.399320619170,337.859131862296,336.830673472069,337.699603802176,336.929692064993,337.959430364420,337.585561009307]';
% timeArr = timeArr(widthData < 400);
% widthData = widthData(widthData < 400);
% widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(18:26);
% widthROI = widthData(18:26);
 
% Loc_05
% timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
% widthData = [336.220707383584,335.627707247544,335.943306074753,336.132384579938,335.486360845161,336.565120869619,336.399967964686,335.418267097731,336.446318675882,336.488468724701,335.774912329361,336.568897534999,335.649109574359,336.262345451981,336.626796414393,336.846926084003,336.272509908059,336.358309924320,336.943501482565,337.660497744354,338.928736411261,339.722644009738,341.854874225844,342.790074850162,342.457556987891,343.405676010749,343.082488796237,342.691633193525,343.565418659439,342.811155087784,342.439825587376,341.164106572620,341.576305259464,342.294949219293,340.973152075606,341.364450684427,341.535026438401,340.470903757789,339.456511018919,339.181625732584,340.129289446916,339.642553697782,340.196129317592,339.088574817088,339.641955633156,339.890327286586,339.823966414805,338.804413113312,339.026600022160,339.241770518134,338.745707468887,338.622199440259,338.785242746414,338.745003359421,337.927518578559,339.093518321424,338.608786744528,338.459011331923,339.294383185969,338.557637855239,338.695099989289,337.865676844744,338.055134628912,337.588900788807,338.140385836968,338.264560314543,338.138498067236,337.429096882465,337.914704710420,338.177041498593,337.837234372716]';
% timeArr = timeArr(widthData < 400);
% widthData = widthData(widthData < 400);
% widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(18:26);
% widthROI = widthData(18:26);

% Loc_06
% timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
% widthData = [329.888643546980,328.460897437125,328.846551733770,329.976235331857,330.416601548900,329.831384912849,329.554958809047,330.868608262370,329.637823313788,329.608426006483,328.966448173496,328.915339265552,329.548965069253,329.336473523782,328.979160951119,328.701534157014,329.919189621169,329.801976454742,328.899432554844,330.843977619476,330.756897182046,330.301923920746,425.532448047580,333.050133470651,333.486014126880,334.057873967180,333.244477685371,334.046285420042,426.835869545472,334.727245172557,333.083477237701,334.324852226816,334.210971070294,333.762016664190,421.231436378863,333.237850987379,332.319218220908,332.779194752454,332.946799006807,332.184359750513,332.175735708721,331.904985080694,332.305055072910,331.977372432824,427.472421198292,332.329805050154,332.542963824375,332.524190240541,331.521696607324,331.356208056694,332.229212491774,332.607873289587,331.900647712958,331.120952130289,331.122761239669,330.808704975847,331.860096592485,330.842261520359,330.685888677580,331.552684643558,330.735619438573,331.126002910247,331.289086151372,330.597456049349,330.331202974939,330.805009624464,330.240691343474,330.532592331288,330.288643316821,329.701030161695,329.868934036895]';
% timeArr = timeArr(widthData < 400);
% widthData = widthData(widthData < 400);
% widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(19:27);
% widthROI = widthData(19:27);

% Loc_07
% timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
% widthData = [337.796457736004,337.336120114515,337.320744612944,338.272689095098,337.317104838432,337.516171668174,337.909984919376,337.282385127884,338.357933282270,337.798113156252,336.966599100927,337.648053119701,337.498076037624,512.551879014240,337.707702637909,337.972576369449,458.097559464691,338.239409596645,338.180179180570,339.106932368380,339.771287226139,341.643127424185,342.637702868792,343.131698785550,344.715608649804,343.843784929491,344.320208823476,343.969403738536,344.476366068073,344.623452490750,343.844177803054,343.361792731522,343.202574298481,425.832462078534,342.848998002329,342.415728849228,342.241771835692,342.664101698763,340.764213866446,341.104379401099,340.787433075702,340.834859509236,340.421775277550,341.103547679416,340.647028674012,340.822383303310,339.361045842325,340.426785661519,340.919690447752,340.200383105133,339.803809588190,339.760601584323,339.895233838610,340.163405060993,339.933857333282,339.908915024348,339.808677081628,339.636461218484,339.642497019892,339.386965581510,339.611304413571,339.756871760821,339.718356044735,339.717923935076,339.413782570094,427.674611381364,339.285841799696,338.819005438747,339.413314259420,339.121386854443,339.662385027034]';
% timeArr = timeArr(widthData < 400);
% widthData = widthData(widthData < 400);
% widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(19:27);
% widthROI = widthData(19:27);

% Loc_08
% timeArr = [-830;-829;-828;-827;-826;-825;-824;-823;-822;-821;-820;-819;-818;-817;-816;-815;-814;-813;-812;-811;-810;-809;-808;-807;-806;-805;-804;-803;-802;-801;-800;-799;-798;-797;-796;-795;-794;-793;-792;-791;-790;-789;-788;-787;-786;-785;-784;-783;-782;-781;-780;-779;-778;-777;-776;-775;-774;-773;-772;-771;-770;-769;-768;-767;-766;-765;-764;-763;-762;-761;-760];
% widthData = [323.617582636037,324.222362867393,324.388079413733,323.487458560824,323.945143256632,324.165304866857,324.000628762991,323.284387757855,324.109896110800,323.950405544309,324.406199524361,324.345390001298,323.540501939000,324.081808958194,324.161989871264,324.300714448995,324.076047071000,323.776018811093,323.155976266298,324.155013315628,325.005633748579,325.606696534262,327.107638252304,327.886686555020,328.841449183179,330.184290414849,329.330843439066,330.260298938462,329.145786205072,329.592344586600,329.357160624535,329.357372802600,328.123259773957,329.110901854087,328.045045472317,328.432652978538,327.299216847724,328.354489364973,326.939546793553,326.732745759273,327.540954889097,326.093167607073,326.154102922929,326.589125555416,326.061080195934,326.777964152296,326.106194983996,327.145819171580,326.322285909168,327.015699116507,326.256722387160,326.653766946076,326.820034031142,325.265242387341,326.107969781727,327.019684155660,326.200343184517,325.663279021995,324.518154494071,325.804274280878,325.209669568160,326.448451964424,325.586005242978,325.569742731242,324.553270254234,325.519126922885,326.049745202390,325.569048140131,326.067446831373,325.132688611618,325.236461215589]';
% timeArr = timeArr(widthData < 400);
% widthData = widthData(widthData < 400);
% widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(19:27);
% widthROI = widthData(19:27);

%Loc_09
timeArr = [-1300;-1290;-1280;-1270;-1260;-1250;-1240;-1230;-1220;-1210;-1200;-1190;-1180;-1170;-1160;-1150;-1140;-1130;-1120;-1110;-1100;-1090;-1080;-1070;-1060;-1050;-1040;-1030;-1020;-1010;-1000;-990;-980;-970;-960;-950;-940;-930;-920;-910;-900;-890;-880;-870;-860;-850;-840;-830;-820;-810;-800;-790;-780;-770;-760;-750;-740;-730;-720;-710;-700;-690;-680;-670;-660;-650;-640;-630;-620;-610;-600;-590;-580;-570;-560;-550;-540;-530;-520;-510;-500;-490;-480;-470;-460;-450;-440;-430;-420;-410;-400;-390;-380;-370;-360;-350;-340;-330;-320;-310;-300];
widthData = [447.711941729591,446.364997841551,446.455017015679,447.817205508703,446.730719327501,447.801686334788,447.548695764563,447.103305889015,447.407612523086,447.274068556189,449.105413884108,447.061220814145,447.196208362712,537.791735992272,449.138052679765,447.390720203866,447.777348644175,448.519273712670,448.266620548720,448.469251686850,447.804378663121,447.758281983474,446.707470778416,446.614359451152,447.473596108979,446.340096422759,517.579385243897,446.536621340074,447.067869953749,446.268080335372,446.331392747427,446.829694252965,552.632949690916,444.617814990645,444.747974480373,446.024040295081,445.609855569855,446.040262689682,448.527151063571,446.211232769515,446.646701840637,447.324363192919,446.349513614730,446.965264875263,446.479297656662,448.171651417093,447.361262837409,447.092795682195,447.243695510826,446.447734271970,447.363561339077,447.427208213525,447.600624791184,518.358941693361,448.432971789191,448.735886557184,446.963652260324,447.617270999422,448.258629423257,448.646290025562,446.531097313467,446.360298961811,446.785893013727,447.328557397546,839.764590579459,445.322229748130,447.955126270304,446.607625838297,447.088724460143,444.845671236785,505.328417956993,445.540939599224,445.783394091748,445.697541685786,446.798551549203,446.741794217365,446.105723974869,445.803991248661,446.358187742784,446.457200154894,447.418082861529,448.486348464196,448.024850149819,446.939966080303,447.593816879380,448.883462470197,447.376678692301,447.679680597514,447.712734895433,448.489207291341,447.787585054042,447.580379500648,447.710244251492,446.994366873507,446.967102202368,560.739974114758,447.708261535872,584.329467840683,446.968462901284,447.850838794741,448.106535142059]';
timeArr = timeArr(widthData < 500);
widthData = widthData(widthData < 500);
%widthData = (widthData - min(widthData))./(max(widthData) - min(widthData));
% timeROI = timeArr(19:27);
% widthROI = widthData(19:27);
% 
% [pVfits, pVfunc] = fitGauss(timeROI,widthROI);

h3 = figure;
plot(timeArr,widthData);
% hold on;
% plot(timeArr,pVfunc(pVfits,timeArr));
